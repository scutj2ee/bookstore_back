<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.scutj2ee.bookstore.dao.CartItemDao">
  <resultMap id="cartItemMap" type="com.scutj2ee.bookstore.entity.CartItem">
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="cart_id" property="cartId" />
    <result column="book_id" property="bookId" />
    <result column="subTotal" property="subtotal" />
    <result column="buyNum" property="buynum" />
  </resultMap>

  <delete id="deleteCartItem" parameterType="java.lang.Integer">
    delete from cart_item
    where id = #{id}
  </delete>

  <insert id="insertCartItem" parameterType="com.scutj2ee.bookstore.entity.CartItem">
    insert into cart_item (cart_id, book_id, subTotal, buyNum)
    values (#{cartId}, #{bookId}, #{subtotal}, #{buynum})
  </insert>

  <update id="updateCartItem" parameterType="com.scutj2ee.bookstore.entity.CartItem">
    update cart_item
    <set>
      <if test="cartId != null and cartId != ''">cart_id = #{cartId},</if>
      <if test="bookId != null and bookId != ''">book_id = #{bookId},</if>
      <if test="subtotal != null and subtotal != ''">subTotal = #{subtotal},</if>
      <if test="buynum != null and buynum != ''">buyNum = #{buynum}</if>
    </set>
    where id = #{id}
  </update>

  <select id="findCartItemById" parameterType="java.lang.Integer" resultMap="cartItemMap">
    select c.*
    from cart_item c
    where c.id = #{id}
  </select>

  <select id="selectAll" parameterType="java.lang.Integer" resultMap="cartItemMap">
    select c.*
    from cart_item c
    where c.cart_id = #{cartId}
  </select>

  <select id="clearAll" parameterType="java.lang.Integer" resultMap="cartItemMap">
    delete from cart_item
    where cart_id = #{cartId}
  </select>
  
  <select id="getCartItemListByParams" resultMap="cartItemMap">
    select c.*
    from cartItem c
    where
    <if test="cartItemId != null and cartItemId != ''">
      c.cartItem_id = #{cartItemId}
    </if>
  </select>
</mapper>